!function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";var r=n(1);e.getCache=r.getCache,function(){window&&(window.One={getCache:r.getCache})}()},function(t,e,n){"use strict";function r(t){l=t}function i(t,n){return void 0===t&&(t="one"),void 0===n&&(n=u.defaultConfig),e.config||e.instances||(e.config=u.configure(n)),e.instances||(e.instances={}),e.instances[t]||(e.instances[t]=a(t)),window&&void 0===window[t]&&(window[t]=e.instances[t]),e.instances[t]}function a(t){var e=new f.default(t),n=function(){e.reset()},r=function(t){return o.putItem(t,e)},i=function(t,n){return d.getItem(t,e,n)},a=function(t,n){return d.getEditItem(t,e,n)},u=function(t){return h.evictItem(t,e)},p=function(){return s.cacheSize(e)},g=function(){return s.cacheLength(e)},m=function(){return c.printCache(e)},v=function(t){var n=d.getCachedItem(t,e);return n.mapFrom},y=function(t){var n=d.getCachedItem(t,e);return n.mapTo},O={put:r,get:i,getEdit:a,evict:u,reset:n,size:p,length:g,print:m,refTo:y,refFrom:v};return l===!1&&(delete O.refTo,delete O.refFrom),O}var u=n(2),o=n(3),c=n(14),f=n(15),s=n(7),d=n(11),h=n(18),l=!1;e.setTesting=r,e.getCache=i},function(t,e){"use strict";function n(t){for(var n in e.defaultConfig)e.defaultConfig.hasOwnProperty(n)&&t.hasOwnProperty(n)&&(e.defaultConfig[n]=t[n]);return e.defaultConfig}e.defaultConfig={uidName:"uid",maxHistoryStates:1e3},e.configure=n},function(t,e,n){"use strict";var r=n(4),i=n(6),a=n(7),u=n(9),o=n(10);e.putItem=function(t,e){if(a.isArray(t)||a.isObject(t)){var n=new r.default,f=new r.default;f.__UPDATED__=!1;var s={entity:t,flushMap:f,evictMap:n,parentUid:null,refPath:"",instance:e};if(o.buildFlushMap(s),u.updatePointers(s),s.flushMap.size()>0&&f.__UPDATED__===!0)return c(s)}return i.getCallStats(!1,e)};var c=function(t){return o.preFlush(t),i.getCallStats(!0,t.instance)}},function(t,e,n){"use strict";var r=n(5),i=function(){function t(){var e=this;this.paths={},this.length=0,this.get=function(t){return e.paths[t]},this.delete=function(t){if("undefined"!=typeof e.paths[t]&&e.length>0){var n=e.paths[t];return delete e.paths[t],e.length--,n}},this.has=function(t){return"undefined"!=typeof e.paths[t]},this.forEach=function(t){for(var n in e.paths)e.paths.hasOwnProperty(n)&&t(n,e.paths[n])},this.clone=function(){var n=r({},e.paths),i=new t;return i.paths=n,i.length=e.length,i}}return t.prototype.set=function(t,e){return"undefined"==typeof this.paths[t]?(this.length++,this.paths[t]=e,!0):(this.paths[t]=e,!1)},t.prototype.size=function(){return this.length},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e){"use strict";function n(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function r(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;var r=Object.getOwnPropertyNames(e).map(function(t){return e[t]});if("0123456789"!==r.join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(t){i[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(t){return!1}}var i=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;t.exports=r()?Object.assign:function(t,e){for(var r,u,o=n(t),c=1;c<arguments.length;c++){r=Object(arguments[c]);for(var f in r)i.call(r,f)&&(o[f]=r[f]);if(Object.getOwnPropertySymbols){u=Object.getOwnPropertySymbols(r);for(var s=0;s<u.length;s++)a.call(r,u[s])&&(o[u[s]]=r[u[s]])}}return o}},function(t,e,n){"use strict";function r(t){var e=t.thread.nodes[t.thread.current];return e>=0?i(e,t):void 0}function i(t,e){return e.repo.get(t)}function a(t,e){for(var n,r,i=0,a=t.length-1;i<=a;)if(n=(i+a)/2|0,r=t[n],r<e)i=n+1;else{if(!(r>e))return n;a=n-1}}var u=n(7);e.getCallStats=function(t,n){var r={};return r.success=t,r.nodeId=e.node(n),r.length=o(n),r.name=n.name,r},e.node=function(t,n){if("undefined"==typeof n){var o=r(t);return o?o.id:-1}if(!u.isNumber(n))throw new TypeError("The node id must be a number.");var c=i(n,t);return c?(t.thread.current=a(t.thread.nodes,n),e.getCallStats(!0,t)):e.getCallStats(!1,t)},e.getCurrentNode=r,e.getRepoNode=i;var o=function(t){return t.thread.nodes.length}},function(t,e,n){"use strict";function r(t){return"number"==typeof t||"[object Number]"===y(t)}function i(t){return"string"==typeof t||"[object String]"===y(t)}function a(t){return"[object Array]"!==Object.prototype.toString.call(t)&&(null!==t&&"object"==typeof t)}function u(t){return!(!t||null===t)&&(Array.isArray(t)||t&&"object"==typeof t&&"number"==typeof t.length&&"function"==typeof t.splice&&!t.propertyIsEnumerable("length"))}function o(t){return Object.prototype.toString.call(t)}function c(t){return a(t)&&"[object Date]"===o(t)}function f(t){if(!t)return!0;if(u(t)&&0===t.length)return!0;if(!i(t)){for(var e in t)if(O.call(t,e))return!1;return!0}return!1}function s(t){var e=new g.CacheNode(t.nextNodeKey);return e.id=t.nextNodeKey,t.nextNodeKey+=1,t.repo.add(e),e}function d(t){if(!t)return!1;if(!a(t))return!1;if("undefined"==typeof t[p.config.uidName])return!1;var e=t[p.config.uidName];return 0!==e.length}function h(t,e,n){if(void 0===n&&(n=!0),!t||!a(t)&&!u(t))return t;if(n===!0&&e&&!Object.isFrozen(e)&&Object.freeze(e),e&&d(t)&&t[p.config.uidName]===e[p.config.uidName])return e;var r=v({},t);for(var i in t){var o=t[i];if(o)if(u(o))r[i]=l(o,e,n);else if(c(o)){var f=new Date(o.getTime());n===!0&&Object.freeze(f),r[i]=f}else a(o)?d(o)?(r[i]=o,e&&d(e)&&o!==e&&o.uid===e.uid&&o!==e&&(r[i]=e)):r[i]=h(o,e,n):r[i]=o}return n!==!0||Object.isFrozen(r)||Object.freeze(r),r}function l(t,e,n){return t.map(function(t){return u(t)?l(t,e,n):a(t)?d(t)?e&&t[p.config.uidName]===e[p.config.uidName]?e:t:h(t,e,n):t})}var p=n(1),g=n(8),m=n(6),v=n(5),y=Object.prototype.toString,O=Object.prototype.hasOwnProperty;e.isNumber=r,e.isString=i,e.isObject=a,e.isArray=u,e.isDate=c,e.isEmpty=f,e.getNewCacheNode=s,e.hasUid=d,e.deepClone=h,e.cacheSize=function(t){var e=m.getCurrentNode(t);return e?e.items.size():0},e.cacheLength=function(t){return t.thread.nodes.length}},function(t,e,n){"use strict";var r=n(4),i=function(){function t(t){this.items=new r.default,this.id=t}return t}();e.CacheNode=i},function(t,e,n){"use strict";var r=n(10),i=n(1),a=n(12),u=n(11),o=n(7);e.assignRefToParent=function(t,e){if(e.parentUid){var n=r.getItemFlushOrCached(e.parentUid,e);n&&e.refPath&&c(n,t,e.refPath)}};var c=function(t,e,n){var r=t.entity[i.config.uidName],a=e.entity[i.config.uidName];f(t,a,n),s(e,r,n)},f=function(t,e,n){t.mapTo.has(e)===!1&&t.mapTo.set(e,[]);var r=t.mapTo.get(e);return r.indexOf(n)<0&&r.push(n),t},s=function(t,e,n){t.mapFrom.has(e)===!1&&t.mapFrom.set(e,[]);var r=t.mapFrom.get(e);return r.indexOf(n)<0&&r.push(n),t};e.updatePointers=function(t){t.flushMap.forEach(function(n,r){d(r,t),e.updateRefFroms(r,t)})},e.updateRefFroms=function(t,e){t.mapFrom.forEach(function(n,i){var c=e.flushMap.get(n);if(c||(c=u.getCachedItem(n,e.instance)),c&&i.length>0){var f=i[0],s=a.get(c.entity,f),d=s&&s!==t.entity;if(d===!0){var h={entity:c.entity,flushMap:e.flushMap,instance:e.instance};c=r.ensureItem(h),c.entity=o.deepClone(c.entity,t.entity,!0)}}})},e.updateRefTos=function(t,e){var n=r.getItemFlushOrCached(t,e);d(n,e)};var d=function(t,e){t&&t.mapTo.forEach(function(n,r){var u=r.map(function(r){var u=a.get(t.entity,r);if(u){var o=u[i.config.uidName];if(o){var c=o==n;if(c===!0)return r}}h(t.entity[i.config.uidName],n,e)}).filter(function(t){return null!==t&&void 0!==t});u.length>0?t.mapTo.set(n,u):t.mapTo.delete(n)})},h=function(t,e,n){var i=r.getItemFlushOrCached(e,n);i&&(i=i.clone(),i.mapFrom.has(t)&&(l(i,t,n.refPath),0===i.mapFrom.size()?(n.evictMap.set(e,i),n.flushMap.delete(e)):(n.flushMap.set(e,i),n.evictMap.delete(e))))},l=function(t,e,n){var r=t.mapFrom.get(e),i=r.indexOf(n);r=r.slice(),r.splice(i,1),t.mapFrom.set(e,r),0==r.length&&t.mapFrom.delete(e)}},function(t,e,n){"use strict";var r=n(11),i=n(1),a=n(7),u=n(12),o=n(13),c=n(4),f=n(9);e.buildFlushMap=function(t){a.hasUid(t.entity)?s(t):a.isArray(t.entity)?l(t):h(t)};var s=function(t){t.refPath="",m(t)===!0&&(d(t),h(t),f.updateRefTos(String(t.entity[i.config.uidName]),t))},d=function(t){var n=String(t.entity[i.config.uidName]);t.flushMap.has(n)===!1&&(e.ensureItem(t),t.parentUid=String(n))},h=function(t){var e=t.entity;for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];(a.isObject(r)||a.isArray(r))&&(t.entity=r,e[i.config.uidName]&&(t.parentUid=e[i.config.uidName]),t.parentUid&&(t.refPath=u.concatProp(t.refPath,n)),t.refPath||(t.refPath=n)),a.isArray(r)?l(t):a.isObject(r)&&p(t),Object.freeze(r)}},l=function(t){var e,n=t.entity,r=t.refPath;e||(e=t.parentUid),n.forEach(function(n,i){t.entity=n,t.parentUid=e,(t.refPath||r)&&(t.refPath=r+"."+i),a.isArray(n)?l(t):a.isObject(n)&&p(t)}),Object.freeze(n)},p=function(t){a.hasUid(t.entity)?g(t):h(t)},g=function(t){var n=e.ensureItem(t);f.assignRefToParent(n,t),r.isOnCache(t)!==!0&&e.buildFlushMap(t)},m=function(t){var e=r.getCachedItem(t.entity[i.config.uidName],t.instance);return!e||e.entity!==t.entity};e.getItemFlushOrCached=function(t,e){if(t){t=String(t);var n=e.flushMap.get(t);return n||(n=r.getCachedItem(t,e.instance)),n&&Object.isFrozen(n)&&(n=n.clone()),n}},e.ensureItem=function(t){var e=String(t.entity[i.config.uidName]),n=t.flushMap.get(e);if(n)return n;var a=r.getCachedItem(e,t.instance);return n=new o.default(t.entity,a),t.flushMap.set(e,n),t.flushMap.__UPDATED__=!0,n},e.preFlush=function(t){var n=new c.default,a=r.getCacheCurrentStack(t.instance);a&&a.forEach(function(t,e){n.set(t,e)}),t.flushMap.forEach(function(t,e){var r=e.entity[i.config.uidName];v(e),n.set(String(r),e)}),t.evictMap.size()>0&&t.evictMap.forEach(function(t,e){n.delete(String(t))}),e.flush(n,t.instance)};var v=function(t){Object.freeze(t),Object.freeze(t.entity),Object.freeze(t.mapTo),Object.freeze(t.mapFrom)};e.flush=function(t,e){if(null!==t){Object.freeze(t);var n=a.getNewCacheNode(e);n.items=t,e.thread.nodes.indexOf(n.id)<0&&(e.thread.nodes.push(n.id),e.thread.current+=1)}}},function(t,e,n){"use strict";function r(t){var e=t.thread.nodes[t.thread.current];return e>=0?i(e,t.repo):void 0}function i(t,e){return e.get(t)}var a=n(1),u=n(7);e.getItem=function(t,e,n){if(!t)throw new TypeError("One get(): requires a uid to retrieve an item from the cache.");return u.isArray(t)?t.map(function(t){return o(t,e)}).filter(function(t){return null!==t&&void 0!==t}):o(t,e)};var o=function(t,n){var r=f(t);if(r){var i=e.getCachedItem(r,n);return i?i.entity:void 0}};e.getEditItem=function(t,e,n){return u.isArray(t)?t.map(function(t){return c(t,e)}).filter(function(t){return null!==t&&void 0!==t}):c(t,e)};var c=function(t,n){var r=f(t),i=e.getItem(r,n);return i?u.deepClone(i,void 0,!1):void 0},f=function(t){return"string"==typeof t?t:"number"==typeof t?String(t):u.isObject(t)&&u.hasUid(t)?t[a.config.uidName]:void 0};e.isOnCache=function(t){var n=t.entity[a.config.uidName],r=e.getCachedItem(n,t.instance);return r&&r.entity===t.entity},e.getCachedItem=function(t,e){var n=r(e);return n?n.items.get(String(t)):void 0},e.getCacheCurrentStack=function(t){var e=r(t);return e?e.items:void 0}},function(t,e,n){"use strict";function r(t){var e=parseInt(t);return e.toString()===t?e:t}function i(t,e){if(u.isNumber(e)&&(e=[e]),!u.isEmpty(t)){if(u.isEmpty(e))return t;if(u.isString(e))return i(t,e.split("."));var n=r(e[0]),a=t[n];if(1===e.length)void 0!==a&&(u.isArray(t)?t.splice(n,1):delete t[n]);else if(void 0!==t[n])return i(t[n],e.slice(1));return t}}function a(t,e,n){if(u.isNumber(e)&&(e=[e]),u.isEmpty(e))return t;if(u.isEmpty(t))return n;if(u.isString(e))return a(t,e.split("."),n);var i=r(e[0]);return 1===e.length?void 0===t[i]?n:t[i]:a(t[i],e.slice(1),n)}var u=n(7);e.del=i,e.get=a,e.concatProp=function(t,e){return t=""===t?e:t+"."+e}},function(t,e,n){"use strict";var r=n(4),i=function(){function t(e,n){var i=this;this.clone=function(){return new t(i.entity,i)},this.entity=e,n?(this.mapFrom=n.mapFrom.clone(),this.mapTo=n.mapTo.clone()):(this.mapFrom=new r.default,this.mapTo=new r.default)}return t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e,n){"use strict";var r=n(1);e.printCache=function(t){var e="",n=0,a=t.thread.current,u=t.thread.nodes;return u.map(function(r){var u=t.repo.get(r),o="",c=n+":"+o+"["+i(u.items)+"]\n\n";n===a&&(c="-> "+c),e+=c,n++}),e=e.substring(0,e.length-2),n=0,"\n------ One -------\nSTACK:\n"+e+"\n\nCONFIG:"+JSON.stringify(r.config,null,2)+"\n\nREPO SIZE:"+t.repo.length+"\n===================\n"};var i=function(t){var e="";return t.forEach(function(t,n){var r=JSON.stringify(n,null,2);e+=r+",\n"}),e}},function(t,e,n){"use strict";var r=n(16),i=n(17),a=function(){function t(t){var e=this;this.repo=new r.default,this.thread=new i.default,this.nextNodeKey=0,this.reset=function(){e.repo=new r.default,e.thread=new i.default,e.nextNodeKey=0},this.addNode=function(t){return!!e.repo.add(t)&&(e.thread.addNode(t.id),e.nextNodeKey++,!0)},this.length=function(){return e.thread.nodes.length},this.size=function(){return e.repo.length},this.name=t}return t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=a},function(t,e,n){"use strict";var r=n(4),i=function(){function t(){var t=this;this.items=new r.default,this.length=0,this.get=function(e){return t.items.get(e)},this.add=function(e){return!t.items.has(e.id)&&(t.items.set(e.id,e),t.length++,!0)},this.delete=function(e){t.items.has(e)&&(t.items.delete(e),t.length--)}}return t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e){"use strict";var n=function(){function t(){var t=this;this.current=-1,this.nodes=[],this.addNode=function(e){t.nodes.push(e),t.current++}}return t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},function(t,e,n){"use strict";var r=n(7),i=n(1),a=n(11),u=n(4),o=n(12),c=n(10),f=n(6),s=n(9);e.evictItem=function(t,e){var n=m(t);if(0==n.length)return f.getCallStats(!1,e);var r=a.getCacheCurrentStack(e),i=n.some(function(t){return r&&r.has(String(t))});if(!i)return f.getCallStats(!1,e);var o=new u.default;r.forEach(function(t,e){o.set(t,e)});var s=new u.default,l=new u.default,g={flushMap:s,evictMap:l,instance:e},v=[];return n.forEach(function(t){g.entityUid=t,h(g),l.set(t,null),p(n,v,g)}),d(v,s,l,e),s.forEach(function(t,e){o.set(t,e)}),l.forEach(function(t,e){o.delete(t)}),c.flush(o,e),f.getCallStats(!0,e)};var d=function(t,e,n,i){if(t&&t.length>0&&r.cacheSize(i)>0){var a={flushMap:e,evictMap:n,instance:i};c.buildFlushMap(a),a.flushMap.forEach(function(t,e){s.updateRefFroms(e,a)})}},h=function(t){var e=a.getCachedItem(t.entityUid,t.instance);e&&e.mapTo.forEach(function(e,n){var r=c.getItemFlushOrCached(e,t);r&&(l(r,t.entityUid),0===r.mapFrom.size()?(t.entityUid=e,h(t),t.evictMap.set(e,r)):t.flushMap.set(e,r))})},l=function(t,e){var n=t.mapFrom.get(e);n&&(t.mapFrom=t.mapFrom.clone(),t.mapFrom.delete(e))},p=function(t,e,n){var r=c.getItemFlushOrCached(n.entityUid,n);r&&r.mapFrom.forEach(function(r,i){var a=c.getItemFlushOrCached(r,n);if(a){var u=g(a,n.entityUid,n.instance);u===!0&&(n.flushMap.set(r,a),t.indexOf(r)<0&&e.push(a))}})},g=function(t,e,n){var r=t.entity;Object.isFrozen(r)&&(r=a.getEditItem(r[i.config.uidName],n),t.entity=r);var u=t.mapTo.get(e);return u.forEach(function(t){o.del(r,t)}),Object.isFrozen(r)||Object.freeze(r),t.entity=r,t.mapTo=t.mapTo.clone(),t.mapTo.delete(e),!0},m=function(t){var e=[];if(r.isArray(t))t.forEach(function(t){r.hasUid(t)?e.push(String(t[i.config.uidName])):"string"!=typeof t&&"number"!=typeof t||e.push(String(t))});else{var n=t;if(r.isObject(t)&&(n=t[i.config.uidName]),void 0===n)return e;e.push(String(n))}return e};e.clearNext=function(t){var e=t.thread;if(e.current<e.nodes.length-1){var n=e.nodes.slice(e.current+1,e.nodes.length);e.nodes=e.nodes.slice(0,e.current+1),e.current=e.nodes.length-1,v(n,t)}};var v=function(t,e){t.forEach(function(t){var n=e.repo.get(t);n&&e.repo.delete(t)})}}]);