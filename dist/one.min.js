!function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";var r=n(1);e.getCache=r.getCache,e.put=r.put,e.get=r.get,e.getEdit=r.getEdit,e.evict=r.evict,e.reset=r.reset,e.uuid=r.uuid,e.print=r.print,function(){"undefined"!=typeof window&&null!==window&&(window.One={getCache:r.getCache,put:r.put,get:r.get,getEdit:r.getEdit,evict:r.evict,reset:r.reset,uuid:r.uuid,print:r.print})}()},function(t,e,n){"use strict";function r(t){p=t}function i(t,n){return void 0===t&&(t="one"),void 0===n&&(n=o.defaultConfig),e.config||(e.config=o.configure(n)),e.instances[t]||(e.instances[t]=u(t)),"undefined"!=typeof window&&null!==window&&void 0===window[t]&&(window[t]=e.instances[t]),e.instances[t]}function u(t){var e=new f.default(t),n=function(){e.reset()},r=function(t){return a.putItem(t,e)},i=function(t,n){return d.getItem(t,e,n)},u=function(t,n){return d.getEditItem(t,e,n)},o=function(t){return h.evictItem(t,e)},g=function(){return s.cacheSize(e)},m=function(){return s.cacheLength(e)},v=function(){return c.printCache(e)},y={put:r,get:i,getEdit:u,evict:o,reset:n,size:g,length:m,print:v};return p===!0&&(y.refTo=function(t){var n=l.getCachedItem(t,e);return n.mapTo},y.refFrom=function(t){var n=l.getCachedItem(t,e);return n.mapFrom}),y}var o=n(2),a=n(3),c=n(14),f=n(15),s=n(6),d=n(18),h=n(19),l=n(10);e.instances={};var p=!1;e.setTesting=r,e.getCache=i,e.put=function(t){i().put(t)},e.get=function(t,e){return i().get(t,e)},e.getEdit=function(t,e){return i().getEdit(t,e)},e.evict=function(t){return i().evict(t)},e.print=function(){return i().print()},e.reset=function(){i().reset()},e.uuid=function(){for(var t=[],e=0;e<256;e++)t[e]=(e<16?"0":"")+e.toString(16);var n=4294967296*Math.random()|0,r=4294967296*Math.random()|0,i=4294967296*Math.random()|0,u=4294967296*Math.random()|0;return t[255&n]+t[n>>8&255]+t[n>>16&255]+t[n>>24&255]+"-"+t[255&r]+t[r>>8&255]+"-"+t[r>>16&15|64]+t[r>>24&255]+"-"+t[63&i|128]+t[i>>8&255]+"-"+t[i>>16&255]+t[i>>24&255]+t[255&u]+t[u>>8&255]+t[u>>16&255]+t[u>>24&255]}},function(t,e){"use strict";function n(t){for(var n in e.defaultConfig)e.defaultConfig.hasOwnProperty(n)&&t.hasOwnProperty(n)&&(e.defaultConfig[n]=t[n]);return e.defaultConfig}e.defaultConfig={uidName:"uid",maxHistoryStates:1e3},e.configure=n},function(t,e,n){"use strict";var r=n(4),i=n(5),u=n(6),o=n(8),a=n(12),c=n(13);e.putItem=function(t,e){if(u.isArray(t)||u.isObject(t)){var n=new r.default,f=new r.default;f.__UPDATED__=!1;var s={flushMap:f,evictMap:n,instance:e};if(c.parse(t,s),o.updatePointers(s),s.flushMap.size()>0)return a.preFlush(s,e),i.getCallStats(!0,e)}return i.getCallStats(!1,e)}},function(t,e){"use strict";var n=this&&this.__assign||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},r=function(){function t(){var e=this;this.paths={},this.length=0,this.get=function(t){return e.paths[t]},this.delete=function(t){if("undefined"!=typeof e.paths[t]&&e.length>0){var n=e.paths[t];return delete e.paths[t],e.length--,n}},this.has=function(t){return"undefined"!=typeof e.paths[t]},this.forEach=function(t){for(var n in e.paths)e.paths.hasOwnProperty(n)&&t(n,e.paths[n])},this.clone=function(){var r=new t;return r.paths=n({},e.paths),r.length=e.length,r}}return t.prototype.set=function(t,e){return"undefined"==typeof this.paths[t]?(this.length++,this.paths[t]=e,!0):(this.paths[t]=e,!1)},t.prototype.size=function(){return this.length},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=r},function(t,e,n){"use strict";function r(t){var e=t.thread.nodes[t.thread.current];return e>=0?i(e,t):void 0}function i(t,e){return e.repo.get(t)}function u(t,e){for(var n,r,i=0,u=t.length-1;i<=u;)if(n=(i+u)/2|0,r=t[n],r<e)i=n+1;else{if(!(r>e))return n;u=n-1}}var o=n(6);e.getCallStats=function(t,n){var r={};return r.success=t,r.nodeId=e.node(n),r.length=a(n),r.name=n.name,r},e.node=function(t,n){if("undefined"==typeof n){var a=r(t);return a?a.id:-1}if(!o.isNumber(n))throw new TypeError("The node id must be a number.");var c=i(n,t);return c?(t.thread.current=u(t.thread.nodes,n),e.getCallStats(!0,t)):e.getCallStats(!1,t)},e.getCurrentNode=r,e.getRepoNode=i;var a=function(t){return t.thread.nodes.length}},function(t,e,n){"use strict";function r(t){return"number"==typeof t||"[object Number]"===O(t)}function i(t){return"string"==typeof t||"[object String]"===O(t)}function u(t){return"[object Array]"!==Object.prototype.toString.call(t)&&(null!==t&&"object"==typeof t)}function o(t){return"function"==typeof t}function a(t){return!(!t||null===t)&&(Array.isArray(t)||t&&"object"==typeof t&&"number"==typeof t.length&&"function"==typeof t.splice&&!t.propertyIsEnumerable("length"))}function c(t){return Object.prototype.toString.call(t)}function f(t){return u(t)&&"[object Date]"===c(t)}function s(t){if(!t)return!0;if(a(t)&&0===t.length)return!0;if(!i(t)){for(var e in t)if(C.call(t,e))return!1;return!0}return!1}function d(t){var e=new m.CacheNode(t.nextNodeKey);return e.id=t.nextNodeKey,t.nextNodeKey+=1,t.repo.add(e),e}function h(t){if(!t)return!1;if(!u(t))return!1;if("undefined"==typeof t[v.config.uidName])return!1;var e=t[v.config.uidName];return 0!==e.length}function l(t,e,n){if(void 0===n&&(n=!0),!t||!u(t)&&!a(t))return t;if(n===!0&&e&&!Object.isFrozen(e)&&Object.freeze(e),e&&h(t)&&t[v.config.uidName]===e[v.config.uidName])return e;var r=g({},t);for(var i in t){var c=t[i];if(c)if(a(c))r[i]=p(c,e,n);else if(f(c)){var s=new Date(c.getTime());n===!0&&Object.freeze(s),r[i]=s}else u(c)?h(c)?(r[i]=c,e&&h(e)&&c!==e&&c.uid===e.uid&&c!==e&&(r[i]=e)):r[i]=l(c,e,n):o(c)?"constructor"!==i&&(r[i]=c.clone(r)):r[i]=c}return n!==!0||Object.isFrozen(r)||"function"==typeof r||Object.freeze(r),r}function p(t,e,n){return t.map(function(t){return a(t)?p(t,e,n):u(t)?h(t)?e&&t[v.config.uidName]===e[v.config.uidName]?e:t:l(t,e,n):t})}var g=this&&this.__assign||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},m=n(7),v=n(1),y=n(5),O=Object.prototype.toString,C=Object.prototype.hasOwnProperty;e.isNumber=r,e.isString=i,e.isObject=u,e.isFunction=o,e.isArray=a,e.isDate=f,e.isEmpty=s,e.getNewCacheNode=d,e.hasUid=h,Function.prototype.clone=function(t){function e(t){var e=t.toString().replace(n,""),i=e.slice(e.indexOf("(")+1,e.indexOf(")")).match(r);return null===i&&(i=[]),i}var n=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,r=/([^\s,]+)/g,i=this.toString();i=i.replace(new RegExp("_this","g"),"this");var u=i.match(/function[^{]+\{([\s\S]*)\}$/)[1];u=u.trim();var o,a=e(this);return u.indexOf("native code")<0&&(o=Function(a,u),o=o.bind(t)),o},e.deepClone=l,e.cacheSize=function(t){var e=y.getCurrentNode(t);return e?e.items.size():0},e.cacheLength=function(t){return t.thread.nodes.length}},function(t,e,n){"use strict";var r=n(4),i=function(){function t(t){this.items=new r.default,this.id=t}return t}();e.CacheNode=i},function(t,e,n){"use strict";var r=n(1),i=n(9),u=n(6),o=n(10);e.assignRefToParent=function(t,e,n,r){if(e){var i=o.getItemFlushOrCached(e,r);i&&n.length>0&&a(i,t,n)}};var a=function(t,e,n){var i=t.entity[r.config.uidName],u=e.entity[r.config.uidName],o=n.join(".");c(t,u,o),f(e,i,o)},c=function(t,e,n){t.mapTo.has(e)===!1&&t.mapTo.set(e,[]);var r=t.mapTo.get(e);return r.indexOf(n)<0&&r.push(n),t},f=function(t,e,n){t.mapFrom.has(e)===!1&&t.mapFrom.set(e,[]);var r=t.mapFrom.get(e);return r.indexOf(n)<0&&r.push(n),t};e.updatePointers=function(t){t.flushMap.forEach(function(n,r){s(r,t),e.updateRefFroms(r,t)})},e.updateRefFroms=function(t,e){t.mapFrom.length>0&&t.mapFrom.forEach(function(n,r){var a=e.flushMap.get(n);if(a||(a=o.getCachedItem(n,e.instance)),a&&r.length>0){var c=r[0],f=i.get(a.entity,c);if(f&&f!==t.entity){var s={flushMap:e.flushMap,instance:e.instance};a=o.ensureItem(a.entity,s),a.entity=u.deepClone(a.entity,t.entity,!0)}}})},e.updateRefTos=function(t,e){var n=o.getItemFlushOrCached(t,e);s(n,e)};var s=function(t,e){t&&t.mapTo&&t.mapTo.forEach(function(n,u){var o=u.filter(function(u){var o=i.get(t.entity,u),a=o&&String(o[r.config.uidName])===String(n);return a||d(t.entity[r.config.uidName],n,e,u),a});o.length>0?t.mapTo.set(n,o):t.mapTo.delete(n)})},d=function(t,e,n,r){var i=o.getItemFlushOrCached(e,n);i&&(i=i.clone(),i.mapFrom.has(t)&&(h(i,t,r),0===i.mapFrom.size()?(n.evictMap.set(e,i),n.flushMap.delete(e)):(n.flushMap.set(e,i),n.evictMap.delete(e))))},h=function(t,e,n){var r=t.mapFrom.get(e),i=r.indexOf(n);r=r.slice(),r.splice(i,1),t.mapFrom.set(e,r),0==r.length&&t.mapFrom.delete(e)}},function(t,e,n){"use strict";function r(t){var e=parseInt(t);return e.toString()===t?e:t}function i(t,e){if(o.isNumber(e)&&(e=[e]),!o.isEmpty(t)){if(o.isEmpty(e))return t;if(o.isString(e))return i(t,e.split("."));var n=r(e[0]),u=t[n];if(1===e.length)void 0!==u&&(o.isArray(t)?t.splice(n,1):delete t[n]);else if(void 0!==t[n])return i(t[n],e.slice(1));return t}}function u(t,e,n){if(o.isNumber(e)&&(e=[e]),o.isEmpty(e))return t;if(o.isEmpty(t))return n;if(o.isString(e))return u(t,e.split("."),n);var i=r(e[0]);return 1===e.length?void 0===t[i]?n:t[i]:u(t[i],e.slice(1),n)}var o=n(6);e.del=i,e.get=u},function(t,e,n){"use strict";function r(t){var e=t.thread.nodes[t.thread.current];return e>=0?i(e,t.repo):void 0}function i(t,e){return e.get(t)}var u=n(11),o=n(1);e.isOnCache=function(t,n){var r=e.getCachedItem(t[o.config.uidName],n);return r&&r.entity===t},e.isOnFlushMap=function(t,e){return!!e.get(t[o.config.uid])},e.getCachedItem=function(t,e){var n=r(e);return n?n.items.get(String(t)):void 0},e.getItemFlushOrCached=function(t,n){if(t){t=String(t);var r=n.flushMap.get(t);return r||(r=e.getCachedItem(t,n.instance)),r&&Object.isFrozen(r)&&(r=r.clone()),r}},e.getCacheCurrentStack=function(t){var e=r(t);return e?e.items:void 0},e.ensureOnFlushMap=function(t,n){var r=String(t[o.config.uidName]);n.flushMap.has(r)||e.ensureItem(t,n)},e.ensureItem=function(t,n){var r=String(t[o.config.uidName]),i=n.flushMap.get(r);if(i)return i;var a=e.getCachedItem(r,n.instance);return i=new u.default(t,a),n.flushMap.set(r,i),n.flushMap.__UPDATED__=!0,i}},function(t,e,n){"use strict";var r=n(4),i=function(){function t(e,n){var i=this;this.clone=function(){return new t(i.entity,i)},this.entity=e,n?(this.mapFrom=n.mapFrom.clone(),this.mapTo=n.mapTo.clone()):(this.mapFrom=new r.default,this.mapTo=new r.default)}return t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e,n){"use strict";var r=n(4),i=n(10),u=n(1),o=n(6);e.preFlush=function(t,n){var o=new r.default,c=i.getCacheCurrentStack(n);c&&c.forEach(function(t,e){o.set(t,e)}),t.flushMap.forEach(function(t,e){var n=e.entity[u.config.uidName];a(e),o.set(String(n),e)}),t.evictMap.size()>0&&t.evictMap.forEach(function(t,e){o.delete(String(t))}),e.flush(o,n)};var a=function(t){Object.freeze(t),Object.freeze(t.entity),Object.freeze(t.mapTo),Object.freeze(t.mapFrom)};e.flush=function(t,e){if(null!==t){Object.freeze(t);var n=o.getNewCacheNode(e);n.items=t,e.thread.nodes.indexOf(n.id)<0&&(e.thread.nodes.push(n.id),e.thread.current+=1)}}},function(t,e,n){"use strict";var r=n(6),i=n(10),u=n(8),o=n(1);e.parse=function(t,e){if(r.hasUid(t)){if(i.isOnCache(t,e.instance))return;a(t,e)}else r.isArray(t)?f(t,null,[],e):r.isObject(t)&&s(t,null,[],e)};var a=function(t,e){i.ensureOnFlushMap(t,e),c(t,t[o.config.uidName],[],e),u.updateRefTos(String(t[o.config.uidName]),e)},c=function(t,e,n,i){void 0===n&&(n=[]);for(var u in t)if(t.hasOwnProperty(u)){var o=t[u];r.isArray(o)?f(o,e,n.concat([u]),i):r.isObject(o)&&s(o,e,n.concat([u]),i),Object.freeze(o)}},f=function(t,e,n,i){void 0===n&&(n=[]),t.forEach(function(t,u){r.isArray(t)?f(t,e,n.concat([u]),i):r.isObject(t)&&s(t,e,n.concat([u]),i)})},s=function(t,e,n,i){r.hasUid(t)?d(t,e,n,i):c(t,e,n,i)},d=function(t,n,r,o){var a=i.ensureItem(t,o);n&&u.assignRefToParent(a,n,r,o),i.isOnCache(t,o.instance)||i.isOnFlushMap(t,o.flushMap)||e.parse(t,o)}},function(t,e,n){"use strict";var r=n(1);e.printCache=function(t){var e="",n=0,u=t.thread.current,o=t.thread.nodes;return o.map(function(r){var o=t.repo.get(r),a="",c=n+":"+a+"["+i(o.items)+"]\n\n";n===u&&(c="-> "+c),e+=c,n++}),e=e.substring(0,e.length-2),n=0,"\n------ One -------\nSTACK:\n"+e+"\n\nCONFIG:"+JSON.stringify(r.config,null,2)+"\n\nREPO SIZE:"+t.repo.length+"\n===================\n"};var i=function(t){var e="";return t.forEach(function(t,n){var r=JSON.stringify(n,null,2);e+=r+",\n"}),e}},function(t,e,n){"use strict";var r=n(16),i=n(17),u=function(){function t(t){var e=this;this.repo=new r.default,this.thread=new i.default,this.nextNodeKey=0,this.reset=function(){e.repo=new r.default,e.thread=new i.default,e.nextNodeKey=0},this.addNode=function(t){return!!e.repo.add(t)&&(e.thread.addNode(t.id),e.nextNodeKey++,!0)},this.length=function(){return e.thread.nodes.length},this.size=function(){return e.repo.length},this.name=t}return t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=u},function(t,e,n){"use strict";var r=n(4),i=function(){function t(){var t=this;this.items=new r.default,this.length=0,this.get=function(e){return t.items.get(e)},this.add=function(e){return!t.items.has(e.id)&&(t.items.set(e.id,e),t.length++,!0)},this.delete=function(e){t.items.has(e)&&(t.items.delete(e),t.length--)}}return t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e){"use strict";var n=function(){function t(){var t=this;this.current=-1,this.nodes=[],this.addNode=function(e){t.nodes.push(e),t.current++}}return t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},function(t,e,n){"use strict";var r=n(1),i=n(6),u=n(10);e.getItem=function(t,e,n){if(!t)throw new TypeError("One get(): requires a uid to retrieve an item from the cache.");return i.isArray(t)?t.map(function(t){return o(t,e)}).filter(function(t){return null!==t&&void 0!==t}):o(t,e)};var o=function(t,e){var n=c(t);if(n){var r=u.getCachedItem(n,e);return r?r.entity:void 0}};e.getEditItem=function(t,e,n){return i.isArray(t)?t.map(function(t){return a(t,e)}).filter(function(t){return null!==t&&void 0!==t}):a(t,e)};var a=function(t,n){var r=c(t),u=e.getItem(r,n);return u?i.deepClone(u,void 0,!1):void 0},c=function(t){return"string"==typeof t?t:"number"==typeof t?String(t):i.isObject(t)&&i.hasUid(t)?t[r.config.uidName]:void 0}},function(t,e,n){"use strict";var r=n(6),i=n(1),u=n(18),o=n(4),a=n(9),c=n(5),f=n(8),s=n(10),d=n(12),h=n(13);e.evictItem=function(t,e){var n=y(t);if(0==n.length)return c.getCallStats(!1,e);var r=s.getCacheCurrentStack(e),i=n.some(function(t){return r&&r.has(String(t))});if(!i)return c.getCallStats(!1,e);var u=new o.default;r.forEach(function(t,e){u.set(t,e)});var a=new o.default,f=new o.default,h={flushMap:a,evictMap:f,instance:e},g=[];return n.forEach(function(t){p(t,h),f.set(t,null),m(t,n,g,h)}),l(g,a,f,e),a.forEach(function(t,e){u.set(t,e)}),f.forEach(function(t,e){u.delete(t)}),d.flush(u,e),c.getCallStats(!0,e)};var l=function(t,e,n,i){if(t&&t.length>0&&r.cacheSize(i)>0){var u={flushMap:e,evictMap:n,instance:i};h.parse(t,u),u.flushMap.forEach(function(t,e){f.updateRefFroms(e,u)})}},p=function(t,e){var n=s.getCachedItem(t,e.instance);n&&n.mapTo.forEach(function(n,r){var i=s.getItemFlushOrCached(n,e);i&&(g(i,t),0===i.mapFrom.size()?(t=n,p(t,e),e.evictMap.set(n,i)):e.flushMap.set(n,i))})},g=function(t,e){var n=t.mapFrom.get(e);n&&(t.mapFrom=t.mapFrom.clone(),t.mapFrom.delete(e))},m=function(t,e,n,r){var i=s.getItemFlushOrCached(t,r);i&&i.mapFrom.forEach(function(i,u){var o=s.getItemFlushOrCached(i,r);if(o){var a=v(o,t,r.instance);a===!0&&(r.flushMap.set(i,o),e.indexOf(i)<0&&n.push(o))}})},v=function(t,e,n){var r=t.entity;Object.isFrozen(r)&&(r=u.getEditItem(r[i.config.uidName],n),t.entity=r);var o=t.mapTo.get(e);return o.forEach(function(t){a.del(r,t)}),Object.isFrozen(r)||Object.freeze(r),t.entity=r,t.mapTo=t.mapTo.clone(),t.mapTo.delete(e),!0},y=function(t){var e=[];if(r.isArray(t))t.forEach(function(t){r.hasUid(t)?e.push(String(t[i.config.uidName])):"string"!=typeof t&&"number"!=typeof t||e.push(String(t))});else{var n=t;if(r.isObject(t)&&(n=t[i.config.uidName]),void 0===n)return e;e.push(String(n))}return e}}]);