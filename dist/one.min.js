!function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1);t.evict=r.evict,t.get=r.get,t.getCache=r.getCache,t.getEdit=r.getEdit,t.print=r.print,t.put=r.put,t.reset=r.reset,t.uuid=r.uuid,function(){"undefined"!=typeof window&&null!==window&&(window.One={getCache:r.getCache,put:r.put,get:r.get,getEdit:r.getEdit,evict:r.evict,reset:r.reset,uuid:r.uuid,print:r.print})}()},function(e,t,n){"use strict";function r(e){p=e}function i(e,n){return void 0===e&&(e="one"),void 0===n&&(n=c.defaultConfig),t.config||(t.config=c.configure(n)),t.instances[e]||(t.instances[e]=u(e)),"undefined"!=typeof window&&null!==window&&void 0===window[e]&&(window[e]=t.instances[e]),t.instances[e]}function u(e){var t=new o.default(e),n=function(){return t.reset()},r=function(e){return l.putItem(e,t)},i=function(e,n){return f.getItem(e,t,n)},u=function(e,n){return f.getEditItem(e,t,n)},c=function(e){return s.evictItem(e,t)},g=function(){return a.cacheSize(t)},v=function(){return a.cacheLength(t)},m=function(){return h.printCache(t)},y={put:r,get:i,getEdit:u,evict:c,reset:n,size:g,length:v,print:m};return p===!0&&(y.refTo=function(e){var n=d.getCachedItem(e,t);return n.mapTo},y.refFrom=function(e){var n=d.getCachedItem(e,t);return n.mapFrom}),y}Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),a=n(6),c=n(9),f=n(10),s=n(13),d=n(11),h=n(18),l=n(19);t.instances={};var p=!1;t.setTesting=r,t.getCache=i,t.put=function(e){i().put(e)},t.get=function(e,t){return i().get(e,t)},t.getEdit=function(e,t){return i().getEdit(e,t)},t.evict=function(e){return i().evict(e)},t.print=function(){return i().print()},t.reset=function(){i().reset()},t.uuid=function(){for(var e=[],t=0;t<256;t++)e[t]=(t<16?"0":"")+t.toString(16);var n=4294967296*Math.random()|0,r=4294967296*Math.random()|0,i=4294967296*Math.random()|0,u=4294967296*Math.random()|0;return e[255&n]+e[n>>8&255]+e[n>>16&255]+e[n>>24&255]+"-"+e[255&r]+e[r>>8&255]+"-"+e[r>>16&15|64]+e[r>>24&255]+"-"+e[63&i|128]+e[i>>8&255]+"-"+e[i>>16&255]+e[i>>24&255]+e[255&u]+e[u>>8&255]+e[u>>16&255]+e[u>>24&255]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=n(5),u=function(){function e(e){var t=this;this.repo=new r.default,this.thread=new i.default,this.nextNodeKey=0,this.reset=function(){t.repo=new r.default,t.thread=new i.default,t.nextNodeKey=0},this.addNode=function(e){return!!t.repo.add(e)&&(t.thread.addNode(e.id),t.nextNodeKey++,!0)},this.length=function(){return t.thread.nodes.length},this.size=function(){return t.repo.length},this.name=e}return e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=function(){function e(){var e=this;this.items=new r.default,this.length=0,this.get=function(t){return e.items.get(t)},this.add=function(t){return!e.items.has(t.id)&&(e.items.set(t.id,t),e.length++,!0)},this.delete=function(t){e.items.has(t)&&(e.items.delete(t),e.length--)}}return e}();t.default=i},function(e,t){"use strict";var n=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){var t=this;this.paths={},this.length=0,this.get=function(e){return t.paths[e]},this.delete=function(e){if("undefined"!=typeof t.paths[e]&&t.length>0){var n=t.paths[e];return delete t.paths[e],t.length--,n}},this.has=function(e){return"undefined"!=typeof t.paths[e]},this.forEach=function(e){for(var n in t.paths)t.paths.hasOwnProperty(n)&&e(n,t.paths[n])},this.clone=function(){var r=new e;return r.paths=n({},t.paths),r.length=t.length,r}}return e.prototype.set=function(e,t){return"undefined"==typeof this.paths[e]?(this.length++,this.paths[e]=t,!0):(this.paths[e]=t,!1)},e.prototype.size=function(){return this.length},e}();t.default=r},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){var e=this;this.current=-1,this.nodes=[],this.addNode=function(t){e.nodes.push(t),e.current++}}return e}();t.default=n},function(e,t,n){"use strict";function r(e){return"number"==typeof e||"[object Number]"===O(e)}function i(e){return"string"==typeof e||"[object String]"===O(e)}function u(e){return"[object Array]"!==Object.prototype.toString.call(e)&&(null!==e&&"object"==typeof e)}function o(e){return"function"==typeof e}function a(e){return!(!e||null===e)&&(Array.isArray(e)||e&&"object"==typeof e&&"number"==typeof e.length&&"function"==typeof e.splice&&!e.propertyIsEnumerable("length"))}function c(e){return Object.prototype.toString.call(e)}function f(e){return u(e)&&"[object Date]"===c(e)}function s(e){if(!e)return!0;if(a(e)&&0===e.length)return!0;if(!i(e)){for(var t in e)if(b.call(e,t))return!1;return!0}return!1}function d(e){var t=new v.CacheNode(e.nextNodeKey);return t.id=e.nextNodeKey,e.nextNodeKey+=1,e.repo.add(t),t}function h(e){if(!e)return!1;if(!u(e))return!1;if("undefined"==typeof e[m.config.uidName])return!1;var t=e[m.config.uidName];return 0!==t.length}function l(e,t,n){if(void 0===n&&(n=!0),!e||!u(e)&&!a(e))return e;if(n===!0&&t&&!Object.isFrozen(t)&&Object.freeze(t),t&&h(e)&&e[m.config.uidName]===t[m.config.uidName])return t;var r=g({},e);for(var i in e){var c=e[i];if(c)if(a(c))r[i]=p(c,t,n);else if(f(c)){var s=new Date(c.getTime());n===!0&&Object.freeze(s),r[i]=s}else u(c)?h(c)?(r[i]=c,t&&h(t)&&c!==t&&c.uid===t.uid&&c!==t&&(r[i]=t)):r[i]=l(c,t,n):o(c)?"constructor"!==i&&(r[i]=c.clone(r)):r[i]=c}return n!==!0||Object.isFrozen(r)||"function"==typeof r||Object.freeze(r),r}function p(e,t,n){return e.map(function(e){return a(e)?p(e,t,n):u(e)?h(e)?t&&e[m.config.uidName]===t[m.config.uidName]?t:e:l(e,t,n):e})}var g=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(t,"__esModule",{value:!0});var v=n(7),m=n(1),y=n(8),O=Object.prototype.toString,b=Object.prototype.hasOwnProperty;t.isNumber=r,t.isString=i,t.isObject=u,t.isFunction=o,t.isArray=a,t.isDate=f,t.isEmpty=s,t.getNewCacheNode=d,t.hasUid=h,Function.prototype.clone=function(e){function t(e){var t=e.toString().replace(n,""),i=t.slice(t.indexOf("(")+1,t.indexOf(")")).match(r);return null===i&&(i=[]),i}var n=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,r=/([^\s,]+)/g,i=this.toString();i=i.replace(new RegExp("_this","g"),"this");var u=i.match(/function[^{]+\{([\s\S]*)\}$/)[1];u=u.trim();var o,a=t(this);return u.indexOf("native code")<0&&(o=Function(a,u),o=o.bind(e)),o},t.deepClone=l,t.cacheSize=function(e){var t=y.getCurrentNode(e);return t?t.items.size():0},t.cacheLength=function(e){return e.thread.nodes.length}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=function(){function e(e){this.items=new r.default,this.id=e}return e}();t.CacheNode=i},function(e,t,n){"use strict";function r(e){var t=e.thread.nodes[e.thread.current];return t>=0?i(t,e):void 0}function i(e,t){return t.repo.get(e)}function u(e,t){for(var n,r,i=0,u=e.length-1;i<=u;)if(n=(i+u)/2|0,r=e[n],r<t)i=n+1;else{if(!(r>t))return n;u=n-1}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(6);t.getCallStats=function(e,n){var r={};return r.success=e,r.nodeId=t.node(n),r.length=a(n),r.name=n.name,r},t.node=function(e,n){if("undefined"==typeof n){var a=r(e);return a?a.id:-1}if(!o.isNumber(n))throw new TypeError("The node id must be a number.");var c=i(n,e);return c?(e.thread.current=u(e.thread.nodes,n),t.getCallStats(!0,e)):t.getCallStats(!1,e)},t.getCurrentNode=r,t.getRepoNode=i;var a=function(e){return e.thread.nodes.length}},function(e,t){"use strict";function n(e){for(var n in t.defaultConfig)t.defaultConfig.hasOwnProperty(n)&&e.hasOwnProperty(n)&&(t.defaultConfig[n]=e[n]);return t.defaultConfig}Object.defineProperty(t,"__esModule",{value:!0}),t.defaultConfig={uidName:"uid",maxHistoryStates:1e3},t.configure=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),i=n(1),u=n(11),o=function(e){return"string"==typeof e?e:"number"==typeof e?String(e):r.isObject(e)&&r.hasUid(e)?e[i.config.uidName]:void 0},a=function(e,t){var n=o(e);if(n){var r=u.getCachedItem(n,t);return r?r.entity:void 0}};t.getItem=function(e,t,n){if(!e)throw new TypeError("One get(): requires a uid to retrieve an item from the cache.");return r.isArray(e)?e.map(function(e){return a(e,t)}).filter(function(e){return null!==e&&void 0!==e}):a(e,t)};var c=function(e,n){var i=o(e),u=t.getItem(i,n);return u?r.deepClone(u,void 0,!1):void 0};t.getEditItem=function(e,t,n){return r.isArray(e)?e.map(function(e){return c(e,t)}).filter(function(e){return null!==e&&void 0!==e}):c(e,t)}},function(e,t,n){"use strict";function r(e){var t=e.thread.nodes[e.thread.current];return t>=0?i(t,e.repo):void 0}function i(e,t){return t.get(e)}Object.defineProperty(t,"__esModule",{value:!0});var u=n(12),o=n(1);t.getCachedItem=function(e,t){var n=r(t);return n?n.items.get(String(e)):void 0},t.isOnCache=function(e,n){var r=t.getCachedItem(e[o.config.uidName],n);return r&&r.entity===e},t.isOnFlushMap=function(e,t){return!!t.get(e[o.config.uid])},t.getItemFlushOrCached=function(e,n){if(e){var r=String(e),i=n.flushMap.get(r);return i||(i=t.getCachedItem(r,n.instance)),i&&Object.isFrozen(i)&&(i=i.clone()),i}},t.getCacheCurrentStack=function(e){var t=r(e);return t?t.items:void 0},t.ensureItem=function(e,n){var r=String(e[o.config.uidName]),i=n.flushMap.get(r);if(i)return i;var a=t.getCachedItem(r,n.instance);return i=new u.default(e,a),n.flushMap.set(r,i),n.flushMap.__UPDATED__=!0,i},t.ensureOnFlushMap=function(e,n){var r=String(e[o.config.uidName]);n.flushMap.has(r)||t.ensureItem(e,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=function(){function e(t,n){var i=this;this.clone=function(){return new e(i.entity,i)},this.entity=t,n?(this.mapFrom=n.mapFrom.clone(),this.mapTo=n.mapTo.clone()):(this.mapFrom=new r.default,this.mapTo=new r.default)}return e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(14),i=n(6),u=n(11),o=n(15),a=n(4),c=n(1),f=n(16),s=n(8),d=n(10),h=n(17),l=function(e){var t=[];if(i.isArray(e))e.forEach(function(e){i.hasUid(e)?t.push(String(e[c.config.uidName])):"string"!=typeof e&&"number"!=typeof e||t.push(String(e))});else{var n=e;if(i.isObject(e)&&(n=e[c.config.uidName]),void 0===n)return t;t.push(String(n))}return t};t.evictItem=function(e,t){var n=l(e);if(0==n.length)return s.getCallStats(!1,t);var r=u.getCacheCurrentStack(t),i=n.some(function(e){return r&&r.has(String(e))});if(!i)return s.getCallStats(!1,t);var o=new a.default;r.forEach(function(e,t){o.set(e,t)});var c=new a.default,d=new a.default,h={flushMap:c,evictMap:d,instance:t},g=[];return n.forEach(function(e){m(e,h),d.set(e,null),y(e,n,g,h)}),p(g,c,d,t),c.forEach(function(e,t){o.set(e,t)}),d.forEach(function(e,t){o.delete(e)}),f.flush(o,t),s.getCallStats(!0,t)};var p=function(e,t,n,r){if(e&&e.length>0&&i.cacheSize(r)>0){var u={flushMap:t,evictMap:n,instance:r};h.parse(e,u),u.flushMap.forEach(function(e,t){o.updateRefFroms(t,u)})}},g=function(e,t){var n=e.mapFrom.get(t);n&&(e.mapFrom=e.mapFrom.clone(),e.mapFrom.delete(t))},v=function(e,t,n){var i=e.entity;Object.isFrozen(i)&&(i=d.getEditItem(i[c.config.uidName],n),e.entity=i);var u=e.mapTo.get(t);return u.forEach(function(e){r.del(i,e)}),Object.isFrozen(i)||Object.freeze(i),e.entity=i,e.mapTo=e.mapTo.clone(),e.mapTo.delete(t),!0},m=function(e,t){var n=u.getCachedItem(e,t.instance);n&&n.mapTo.forEach(function(n,r){var i=u.getItemFlushOrCached(n,t);i&&(g(i,e),0===i.mapFrom.size()?(m(n,t),t.evictMap.set(n,i)):t.flushMap.set(n,i))})},y=function(e,t,n,r){var i=u.getItemFlushOrCached(e,r);i&&i.mapFrom.forEach(function(i,o){var a=u.getItemFlushOrCached(i,r);if(a){var c=v(a,e,r.instance);c===!0&&(r.flushMap.set(i,a),t.indexOf(i)<0&&n.push(a))}})}},function(e,t,n){"use strict";function r(e){var t=parseInt(e);return t.toString()===e?t:e}function i(e,t){if(o.isNumber(t)&&(t=[t]),!o.isEmpty(e)){if(o.isEmpty(t))return e;if(o.isString(t))return i(e,t.split("."));var n=r(t[0]),u=e[n];if(1===t.length)void 0!==u&&(o.isArray(e)?e.splice(n,1):delete e[n]);else if(void 0!==e[n])return i(e[n],t.slice(1));return e}}function u(e,t,n){if(o.isNumber(t)&&(t=[t]),o.isEmpty(t))return e;if(o.isEmpty(e))return n;if(o.isString(t))return u(e,t.split("."),n);var i=r(t[0]);return 1===t.length?void 0===e[i]?n:e[i]:u(e[i],t.slice(1),n)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(6);t.del=i,t.get=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(14),i=n(11),u=n(1),o=n(6),a=function(e,t,n){e.mapTo.has(t)===!1&&e.mapTo.set(t,[]);var r=e.mapTo.get(t);return r.indexOf(n)<0&&r.push(n),e},c=function(e,t,n){e.mapFrom.has(t)===!1&&e.mapFrom.set(t,[]);var r=e.mapFrom.get(t);return r.indexOf(n)<0&&r.push(n),e},f=function(e,t,n){var r=e.entity[u.config.uidName],i=t.entity[u.config.uidName],o=n.join(".");a(e,i,o),c(t,r,o)};t.assignRefToParent=function(e,t,n,r){if(t){var u=i.getItemFlushOrCached(t,r);u&&n.length>0&&f(u,e,n)}},t.updateRefFroms=function(e,t){e.mapFrom.length>0&&e.mapFrom.forEach(function(n,u){var a=t.flushMap.get(n);if(a||(a=i.getCachedItem(n,t.instance)),a&&u.length>0){var c=u[0],f=r.get(a.entity,c);if(f&&f!==e.entity){var s={flushMap:t.flushMap,instance:t.instance};a=i.ensureItem(a.entity,s),a.entity=o.deepClone(a.entity,e.entity,!0)}}})};var s=function(e,t,n){var r=e.mapFrom.get(t),i=r.indexOf(n);r=r.slice(),r.splice(i,1),e.mapFrom.set(t,r),0==r.length&&e.mapFrom.delete(t)},d=function(e,t,n,r){var u=i.getItemFlushOrCached(t,n);u&&(u=u.clone(),u.mapFrom.has(e)&&(s(u,e,r),0===u.mapFrom.size()?(n.evictMap.set(t,u),n.flushMap.delete(t)):(n.flushMap.set(t,u),n.evictMap.delete(t))))},h=function(e,t){e&&e.mapTo&&e.mapTo.forEach(function(n,i){var o=i.filter(function(i){var o=r.get(e.entity,i),a=o&&String(o[u.config.uidName])===String(n);return a||d(e.entity[u.config.uidName],n,t,i),a});o.length>0?e.mapTo.set(n,o):e.mapTo.delete(n)})};t.updatePointers=function(e){e.flushMap.forEach(function(n,r){h(r,e),t.updateRefFroms(r,e)})},t.updateRefTos=function(e,t){var n=i.getItemFlushOrCached(e,t);h(n,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=n(1),u=n(11),o=n(6),a=function(e){Object.freeze(e),Object.freeze(e.entity),Object.freeze(e.mapTo),Object.freeze(e.mapFrom)};t.flush=function(e,t){if(null!==e){Object.freeze(e);var n=o.getNewCacheNode(t);n.items=e,t.thread.nodes.indexOf(n.id)<0&&(t.thread.nodes.push(n.id),t.thread.current+=1)}},t.preFlush=function(e,n){var o=new r.default,c=u.getCacheCurrentStack(n);c&&c.forEach(function(e,t){o.set(e,t)}),e.flushMap.forEach(function(e,t){var n=t.entity[i.config.uidName];a(t),o.set(String(n),t)}),e.evictMap.size()>0&&e.evictMap.forEach(function(e,t){o.delete(String(e))}),t.flush(o,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(15),i=n(11),u=n(6),o=n(1);t.parse=function(e,t){if(u.hasUid(e)){if(i.isOnCache(e,t.instance))return;a(e,t)}else u.isArray(e)?s(e,null,[],t):u.isObject(e)&&f(e,null,[],t)};var a=function(e,t){i.ensureOnFlushMap(e,t),d(e,e[o.config.uidName],[],t),r.updateRefTos(String(e[o.config.uidName]),t)},c=function(e,n,u,o){var a=i.ensureItem(e,o);n&&r.assignRefToParent(a,n,u,o),i.isOnCache(e,o.instance)||i.isOnFlushMap(e,o.flushMap)||t.parse(e,o)},f=function(e,t,n,r){u.hasUid(e)?c(e,t,n,r):d(e,t,n,r)},s=function(e,t,n,r){void 0===n&&(n=[]),e.forEach(function(e,i){u.isArray(e)?s(e,t,n.concat([i]),r):u.isObject(e)&&f(e,t,n.concat([i]),r)})},d=function(e,t,n,r){void 0===n&&(n=[]);for(var i in e)if(e.hasOwnProperty(i)){var o=e[i];u.isArray(o)?s(o,t,n.concat([i]),r):u.isObject(o)&&f(o,t,n.concat([i]),r),Object.freeze(o)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=function(e){var t="";return e.forEach(function(e,n){var r=JSON.stringify(n,null,2);t+=r+",\n"}),t};t.printCache=function(e){var t="",n=0,u=e.thread.current,o=e.thread.nodes;return o.map(function(r){var o=e.repo.get(r),a="",c=n+":"+a+"["+i(o.items)+"]\n\n";n===u&&(c="-> "+c),t+=c,n++}),t=t.substring(0,t.length-2),n=0,"\n------ One -------\nSTACK:\n"+t+"\n\nCONFIG:"+JSON.stringify(r.config,null,2)+"\n\nREPO SIZE:"+e.repo.length+"\n===================\n"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),i=n(4),u=n(8),o=n(17),a=n(16),c=n(15);t.putItem=function(e,t){if(r.isArray(e)||r.isObject(e)){var n=new i.default,f=new i.default;f.__UPDATED__=!1;var s={flushMap:f,evictMap:n,instance:t};if(o.parse(e,s),c.updatePointers(s),s.flushMap.size()>0)return a.preFlush(s,t),u.getCallStats(!0,t)}return u.getCallStats(!1,t)}}]);